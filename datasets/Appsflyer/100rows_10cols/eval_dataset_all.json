{
  "metadata": {
    "generated_at": "2025-10-16T14:13:31.025617",
    "source_data": "synthetic marketing data",
    "total_cases": 49
  },
  "categories": {
    "data_aggregation": {
      "description": "Test cases for grouping and aggregating data with sum, avg, min, max",
      "count": 25,
      "cases": [
        {
          "id": "agg_1",
          "category": "data_aggregation",
          "question": "What is the total of Clicks by Agency/PMD (af_prt)?",
          "operation": "GROUP BY Agency/PMD (af_prt), SUM(Clicks)",
          "group_by_column": "Agency/PMD (af_prt)",
          "metric_column": "Clicks",
          "aggregation_function": "sum",
          "expected_result": {
            "Agency_1": 1192.0,
            "Agency_2": 982.0,
            "Agency_3": 3421.0,
            "Agency_4": 2303.0,
            "Agency_5": 277.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_2",
          "category": "data_aggregation",
          "question": "What is the max of Conversions by Conversion Type?",
          "operation": "GROUP BY Conversion Type, MAX(Conversions)",
          "group_by_column": "Conversion Type",
          "metric_column": "Conversions",
          "aggregation_function": "max",
          "expected_result": {
            "install": 50.0,
            "lead": 49.0,
            "purchase": 50.0,
            "re-attribution": 47.0,
            "sign_up": 50.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_3",
          "category": "data_aggregation",
          "question": "What is the number of of Conversion Rate by Media Source (pid)?",
          "operation": "GROUP BY Media Source (pid), COUNT(Conversion Rate)",
          "group_by_column": "Media Source (pid)",
          "metric_column": "Conversion Rate",
          "aggregation_function": "count",
          "expected_result": {
            "applovin_int": 11.0,
            "bing_int": 18.0,
            "direct": 17.0,
            "facebook_int": 9.0,
            "googleadwords_int": 8.0,
            "organic": 12.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_4",
          "category": "data_aggregation",
          "question": "What is the number of of Conversions by Conversion Type?",
          "operation": "GROUP BY Conversion Type, COUNT(Conversions)",
          "group_by_column": "Conversion Type",
          "metric_column": "Conversions",
          "aggregation_function": "count",
          "expected_result": {
            "install": 26.0,
            "lead": 16.0,
            "purchase": 20.0,
            "re-attribution": 20.0,
            "sign_up": 18.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_5",
          "category": "data_aggregation",
          "question": "What is the number of of Sessions by Agency/PMD (af_prt)?",
          "operation": "GROUP BY Agency/PMD (af_prt), COUNT(Sessions)",
          "group_by_column": "Agency/PMD (af_prt)",
          "metric_column": "Sessions",
          "aggregation_function": "count",
          "expected_result": {
            "Agency_1": 6.0,
            "Agency_2": 5.0,
            "Agency_3": 9.0,
            "Agency_4": 6.0,
            "Agency_5": 2.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_6",
          "category": "data_aggregation",
          "question": "What is the max of Conversions by Conversion Type?",
          "operation": "GROUP BY Conversion Type, MAX(Conversions)",
          "group_by_column": "Conversion Type",
          "metric_column": "Conversions",
          "aggregation_function": "max",
          "expected_result": {
            "install": 50.0,
            "lead": 49.0,
            "purchase": 50.0,
            "re-attribution": 47.0,
            "sign_up": 50.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_7",
          "category": "data_aggregation",
          "question": "What is the total of Clicks by Campaign (c)?",
          "operation": "GROUP BY Campaign (c), SUM(Clicks)",
          "group_by_column": "Campaign (c)",
          "metric_column": "Clicks",
          "aggregation_function": "sum",
          "expected_result": {
            "App_Install_Campaign_Android": 6834.0,
            "Brand_Campaign_Q3": 5508.0,
            "Generic_Campaign_Mobile": 5302.0,
            "Lead_Generation_Campaign": 4277.0,
            "Retargeting_Campaign_Web": 4299.0,
            "SB_UAC_Hindi_KYC_Completed_April'24": 3093.0,
            "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 5441.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_8",
          "category": "data_aggregation",
          "question": "What is the min of Clicks by Agency/PMD (af_prt)?",
          "operation": "GROUP BY Agency/PMD (af_prt), MIN(Clicks)",
          "group_by_column": "Agency/PMD (af_prt)",
          "metric_column": "Clicks",
          "aggregation_function": "min",
          "expected_result": {
            "Agency_1": 153.0,
            "Agency_2": 5.0,
            "Agency_3": 136.0,
            "Agency_4": 261.0,
            "Agency_5": 104.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_9",
          "category": "data_aggregation",
          "question": "What is the avg of Conversions by Conversion Type?",
          "operation": "GROUP BY Conversion Type, MEAN(Conversions)",
          "group_by_column": "Conversion Type",
          "metric_column": "Conversions",
          "aggregation_function": "mean",
          "expected_result": {
            "install": 25.384615384615383,
            "lead": 34.0625,
            "purchase": 27.75,
            "re-attribution": 24.0,
            "sign_up": 27.666666666666668
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_10",
          "category": "data_aggregation",
          "question": "What is the avg of Conversions by Conversion Type?",
          "operation": "GROUP BY Conversion Type, MEAN(Conversions)",
          "group_by_column": "Conversion Type",
          "metric_column": "Conversions",
          "aggregation_function": "mean",
          "expected_result": {
            "install": 25.384615384615383,
            "lead": 34.0625,
            "purchase": 27.75,
            "re-attribution": 24.0,
            "sign_up": 27.666666666666668
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_11",
          "category": "data_aggregation",
          "question": "What is the total of Conversions by Agency/PMD (af_prt)?",
          "operation": "GROUP BY Agency/PMD (af_prt), SUM(Conversions)",
          "group_by_column": "Agency/PMD (af_prt)",
          "metric_column": "Conversions",
          "aggregation_function": "sum",
          "expected_result": {
            "Agency_1": 160.0,
            "Agency_2": 144.0,
            "Agency_3": 211.0,
            "Agency_4": 168.0,
            "Agency_5": 79.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_12",
          "category": "data_aggregation",
          "question": "What is the min of Conversion Rate by Conversion Type?",
          "operation": "GROUP BY Conversion Type, MIN(Conversion Rate)",
          "group_by_column": "Conversion Type",
          "metric_column": "Conversion Rate",
          "aggregation_function": "min",
          "expected_result": {
            "install": 0.0002,
            "lead": 0.0072,
            "purchase": 0.0005,
            "re-attribution": 0.0003,
            "sign_up": 0.0008
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_13",
          "category": "data_aggregation",
          "question": "What is the total of Conversions by Country?",
          "operation": "GROUP BY Country, SUM(Conversions)",
          "group_by_column": "Country",
          "metric_column": "Conversions",
          "aggregation_function": "sum",
          "expected_result": {
            "AU": 275.0,
            "BR": 270.0,
            "CA": 347.0,
            "DE": 372.0,
            "FR": 441.0,
            "GB": 147.0,
            "IN": 137.0,
            "JP": 461.0,
            "US": 288.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_14",
          "category": "data_aggregation",
          "question": "What is the total of Conversion Rate by Conversion Type?",
          "operation": "GROUP BY Conversion Type, SUM(Conversion Rate)",
          "group_by_column": "Conversion Type",
          "metric_column": "Conversion Rate",
          "aggregation_function": "sum",
          "expected_result": {
            "install": 0.2656,
            "lead": 0.4053,
            "purchase": 0.5464,
            "re-attribution": 0.3549,
            "sign_up": 0.2196
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_15",
          "category": "data_aggregation",
          "question": "What is the number of of Conversions by Agency/PMD (af_prt)?",
          "operation": "GROUP BY Agency/PMD (af_prt), COUNT(Conversions)",
          "group_by_column": "Agency/PMD (af_prt)",
          "metric_column": "Conversions",
          "aggregation_function": "count",
          "expected_result": {
            "Agency_1": 6.0,
            "Agency_2": 5.0,
            "Agency_3": 9.0,
            "Agency_4": 6.0,
            "Agency_5": 2.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_16",
          "category": "data_aggregation",
          "question": "What is the number of of Clicks by Agency/PMD (af_prt)?",
          "operation": "GROUP BY Agency/PMD (af_prt), COUNT(Clicks)",
          "group_by_column": "Agency/PMD (af_prt)",
          "metric_column": "Clicks",
          "aggregation_function": "count",
          "expected_result": {
            "Agency_1": 3.0,
            "Agency_2": 4.0,
            "Agency_3": 8.0,
            "Agency_4": 4.0,
            "Agency_5": 2.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_17",
          "category": "data_aggregation",
          "question": "What is the min of Sessions by Campaign (c)?",
          "operation": "GROUP BY Campaign (c), MIN(Sessions)",
          "group_by_column": "Campaign (c)",
          "metric_column": "Sessions",
          "aggregation_function": "min",
          "expected_result": {
            "App_Install_Campaign_Android": 482.0,
            "Brand_Campaign_Q3": 526.0,
            "Generic_Campaign_Mobile": 188.0,
            "Lead_Generation_Campaign": 82.0,
            "Retargeting_Campaign_Web": 539.0,
            "SB_UAC_Hindi_KYC_Completed_April'24": 545.0,
            "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 298.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_18",
          "category": "data_aggregation",
          "question": "What is the avg of Sessions by Agency/PMD (af_prt)?",
          "operation": "GROUP BY Agency/PMD (af_prt), MEAN(Sessions)",
          "group_by_column": "Agency/PMD (af_prt)",
          "metric_column": "Sessions",
          "aggregation_function": "mean",
          "expected_result": {
            "Agency_1": 1866.5,
            "Agency_2": 2315.0,
            "Agency_3": 2256.4444444444443,
            "Agency_4": 2010.0,
            "Agency_5": 1559.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_19",
          "category": "data_aggregation",
          "question": "What is the avg of Sessions by Country?",
          "operation": "GROUP BY Country, MEAN(Sessions)",
          "group_by_column": "Country",
          "metric_column": "Sessions",
          "aggregation_function": "mean",
          "expected_result": {
            "AU": 2242.4,
            "BR": 2816.9166666666665,
            "CA": 2035.0,
            "DE": 2576.0,
            "FR": 2578.0588235294117,
            "GB": 2317.8,
            "IN": 2305.0,
            "JP": 1854.375,
            "US": 2476.818181818182
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_20",
          "category": "data_aggregation",
          "question": "What is the number of of Conversion Rate by Media Source (pid)?",
          "operation": "GROUP BY Media Source (pid), COUNT(Conversion Rate)",
          "group_by_column": "Media Source (pid)",
          "metric_column": "Conversion Rate",
          "aggregation_function": "count",
          "expected_result": {
            "applovin_int": 11.0,
            "bing_int": 18.0,
            "direct": 17.0,
            "facebook_int": 9.0,
            "googleadwords_int": 8.0,
            "organic": 12.0
          },
          "difficulty": "medium"
        },
        {
          "id": "agg_multi_1",
          "category": "data_aggregation_multi_group",
          "question": "What is the avg of Sessions grouped by Agency/PMD (af_prt) and Media Source (pid)?",
          "operation": "GROUP BY Agency/PMD (af_prt), Media Source (pid), MEAN(Sessions)",
          "group_by_columns": [
            "Agency/PMD (af_prt)",
            "Media Source (pid)"
          ],
          "metric_column": "Sessions",
          "aggregation_function": "mean",
          "expected_result": {
            "Agency_1_bing_int": 2512.5,
            "Agency_1_direct": 1688.5,
            "Agency_1_googleadwords_int": 2271.0,
            "Agency_1_organic": 526.0,
            "Agency_2_applovin_int": 4991.0,
            "Agency_2_facebook_int": 188.0,
            "Agency_2_googleadwords_int": 1617.5,
            "Agency_2_organic": 3161.0,
            "Agency_3_applovin_int": 4439.0,
            "Agency_3_bing_int": 2051.0,
            "Agency_3_direct": 1378.0,
            "Agency_3_facebook_int": 674.0,
            "Agency_3_organic": 4235.0,
            "Agency_4_bing_int": 2166.5,
            "Agency_4_direct": 1435.5,
            "Agency_4_googleadwords_int": 687.0,
            "Agency_4_organic": 4169.0,
            "Agency_5_applovin_int": 1640.0,
            "Agency_5_organic": 1478.0
          },
          "difficulty": "hard"
        },
        {
          "id": "agg_multi_2",
          "category": "data_aggregation_multi_group",
          "question": "What is the number of of Conversion Rate grouped by Media Source (pid) and Conversion Type?",
          "operation": "GROUP BY Media Source (pid), Conversion Type, COUNT(Conversion Rate)",
          "group_by_columns": [
            "Media Source (pid)",
            "Conversion Type"
          ],
          "metric_column": "Conversion Rate",
          "aggregation_function": "count",
          "expected_result": {
            "applovin_int_install": 4.0,
            "applovin_int_lead": 2.0,
            "applovin_int_purchase": 1.0,
            "applovin_int_re-attribution": 2.0,
            "applovin_int_sign_up": 2.0,
            "bing_int_install": 4.0,
            "bing_int_lead": 5.0,
            "bing_int_purchase": 3.0,
            "bing_int_re-attribution": 3.0,
            "bing_int_sign_up": 3.0,
            "direct_install": 2.0,
            "direct_lead": 1.0,
            "direct_purchase": 5.0,
            "direct_re-attribution": 4.0,
            "direct_sign_up": 5.0,
            "facebook_int_install": 2.0,
            "facebook_int_lead": 1.0,
            "facebook_int_purchase": 1.0,
            "facebook_int_re-attribution": 3.0,
            "facebook_int_sign_up": 2.0,
            "googleadwords_int_install": 3.0,
            "googleadwords_int_lead": 1.0,
            "googleadwords_int_purchase": 2.0,
            "googleadwords_int_re-attribution": 1.0,
            "googleadwords_int_sign_up": 1.0,
            "organic_install": 2.0,
            "organic_lead": 2.0,
            "organic_purchase": 5.0,
            "organic_re-attribution": 2.0,
            "organic_sign_up": 1.0
          },
          "difficulty": "hard"
        },
        {
          "id": "agg_multi_3",
          "category": "data_aggregation_multi_group",
          "question": "What is the number of of Conversion Rate grouped by Agency/PMD (af_prt) and Conversion Type?",
          "operation": "GROUP BY Agency/PMD (af_prt), Conversion Type, COUNT(Conversion Rate)",
          "group_by_columns": [
            "Agency/PMD (af_prt)",
            "Conversion Type"
          ],
          "metric_column": "Conversion Rate",
          "aggregation_function": "count",
          "expected_result": {
            "Agency_1_install": 1.0,
            "Agency_1_purchase": 1.0,
            "Agency_1_re-attribution": 2.0,
            "Agency_1_sign_up": 1.0,
            "Agency_2_install": 1.0,
            "Agency_2_lead": 1.0,
            "Agency_2_purchase": 1.0,
            "Agency_3_install": 1.0,
            "Agency_3_lead": 0.0,
            "Agency_3_purchase": 0.0,
            "Agency_3_re-attribution": 3.0,
            "Agency_3_sign_up": 1.0,
            "Agency_4_install": 0.0,
            "Agency_4_lead": 2.0,
            "Agency_4_purchase": 2.0,
            "Agency_4_re-attribution": 0.0,
            "Agency_5_install": 1.0,
            "Agency_5_sign_up": 1.0
          },
          "difficulty": "hard"
        },
        {
          "id": "agg_multi_4",
          "category": "data_aggregation_multi_group",
          "question": "What is the number of of Sessions grouped by Media Source (pid) and Conversion Type?",
          "operation": "GROUP BY Media Source (pid), Conversion Type, COUNT(Sessions)",
          "group_by_columns": [
            "Media Source (pid)",
            "Conversion Type"
          ],
          "metric_column": "Sessions",
          "aggregation_function": "count",
          "expected_result": {
            "applovin_int_install": 5.0,
            "applovin_int_lead": 3.0,
            "applovin_int_purchase": 1.0,
            "applovin_int_re-attribution": 3.0,
            "applovin_int_sign_up": 2.0,
            "bing_int_install": 9.0,
            "bing_int_lead": 6.0,
            "bing_int_purchase": 3.0,
            "bing_int_re-attribution": 4.0,
            "bing_int_sign_up": 4.0,
            "direct_install": 4.0,
            "direct_lead": 1.0,
            "direct_purchase": 8.0,
            "direct_re-attribution": 5.0,
            "direct_sign_up": 5.0,
            "facebook_int_install": 2.0,
            "facebook_int_lead": 2.0,
            "facebook_int_purchase": 1.0,
            "facebook_int_re-attribution": 4.0,
            "facebook_int_sign_up": 3.0,
            "googleadwords_int_install": 4.0,
            "googleadwords_int_lead": 1.0,
            "googleadwords_int_purchase": 2.0,
            "googleadwords_int_re-attribution": 2.0,
            "googleadwords_int_sign_up": 1.0,
            "organic_install": 2.0,
            "organic_lead": 3.0,
            "organic_purchase": 5.0,
            "organic_re-attribution": 2.0,
            "organic_sign_up": 3.0
          },
          "difficulty": "hard"
        },
        {
          "id": "agg_multi_5",
          "category": "data_aggregation_multi_group",
          "question": "What is the number of of Conversions grouped by Agency/PMD (af_prt) and Conversion Type?",
          "operation": "GROUP BY Agency/PMD (af_prt), Conversion Type, COUNT(Conversions)",
          "group_by_columns": [
            "Agency/PMD (af_prt)",
            "Conversion Type"
          ],
          "metric_column": "Conversions",
          "aggregation_function": "count",
          "expected_result": {
            "Agency_1_install": 1.0,
            "Agency_1_purchase": 2.0,
            "Agency_1_re-attribution": 2.0,
            "Agency_1_sign_up": 1.0,
            "Agency_2_install": 1.0,
            "Agency_2_lead": 3.0,
            "Agency_2_purchase": 1.0,
            "Agency_3_install": 2.0,
            "Agency_3_lead": 1.0,
            "Agency_3_purchase": 1.0,
            "Agency_3_re-attribution": 3.0,
            "Agency_3_sign_up": 2.0,
            "Agency_4_install": 1.0,
            "Agency_4_lead": 2.0,
            "Agency_4_purchase": 2.0,
            "Agency_4_re-attribution": 1.0,
            "Agency_5_install": 1.0,
            "Agency_5_sign_up": 1.0
          },
          "difficulty": "hard"
        }
      ]
    },
    "time_period_comparison": {
      "description": "Test cases for comparing metrics between different time periods",
      "count": 20,
      "cases": [
        {
          "id": "time_comp_1",
          "category": "time_period_comparison",
          "question": "Compare the total Conversion Rate between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Conversion Rate",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 0.9793
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 0.8125
          },
          "expected_result": {
            "period_1_value": 0.9793,
            "period_2_value": 0.8125,
            "absolute_difference": -0.16679999999999995,
            "percent_change": -17.03
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_2",
          "category": "time_period_comparison",
          "question": "Compare the total Conversions between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Conversions",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 1387.0
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 1351.0
          },
          "expected_result": {
            "period_1_value": 1387.0,
            "period_2_value": 1351.0,
            "absolute_difference": -36.0,
            "percent_change": -2.6
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_3",
          "category": "time_period_comparison",
          "question": "Compare the total Sessions between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Sessions",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 116191.0
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 119765.0
          },
          "expected_result": {
            "period_1_value": 116191.0,
            "period_2_value": 119765.0,
            "absolute_difference": 3574.0,
            "percent_change": 3.08
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_4",
          "category": "time_period_comparison",
          "question": "Compare the total Conversion Rate between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Conversion Rate",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 0.9793
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 0.8125
          },
          "expected_result": {
            "period_1_value": 0.9793,
            "period_2_value": 0.8125,
            "absolute_difference": -0.16679999999999995,
            "percent_change": -17.03
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_5",
          "category": "time_period_comparison",
          "question": "Compare the total Conversions between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Conversions",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 1387.0
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 1351.0
          },
          "expected_result": {
            "period_1_value": 1387.0,
            "period_2_value": 1351.0,
            "absolute_difference": -36.0,
            "percent_change": -2.6
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_6",
          "category": "time_period_comparison",
          "question": "Compare the total Clicks between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Clicks",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 15898.0
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 18856.0
          },
          "expected_result": {
            "period_1_value": 15898.0,
            "period_2_value": 18856.0,
            "absolute_difference": 2958.0,
            "percent_change": 18.61
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_7",
          "category": "time_period_comparison",
          "question": "Compare the total Conversions between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Conversions",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 1387.0
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 1351.0
          },
          "expected_result": {
            "period_1_value": 1387.0,
            "period_2_value": 1351.0,
            "absolute_difference": -36.0,
            "percent_change": -2.6
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_8",
          "category": "time_period_comparison",
          "question": "Compare the total Conversions between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Conversions",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 1387.0
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 1351.0
          },
          "expected_result": {
            "period_1_value": 1387.0,
            "period_2_value": 1351.0,
            "absolute_difference": -36.0,
            "percent_change": -2.6
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_9",
          "category": "time_period_comparison",
          "question": "Compare the total Clicks between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Clicks",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 15898.0
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 18856.0
          },
          "expected_result": {
            "period_1_value": 15898.0,
            "period_2_value": 18856.0,
            "absolute_difference": 2958.0,
            "percent_change": 18.61
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_10",
          "category": "time_period_comparison",
          "question": "Compare the total Conversion Rate between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Conversion Rate",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 0.9793
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 0.8125
          },
          "expected_result": {
            "period_1_value": 0.9793,
            "period_2_value": 0.8125,
            "absolute_difference": -0.16679999999999995,
            "percent_change": -17.03
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_11",
          "category": "time_period_comparison",
          "question": "Compare the total Sessions between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Sessions",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 116191.0
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 119765.0
          },
          "expected_result": {
            "period_1_value": 116191.0,
            "period_2_value": 119765.0,
            "absolute_difference": 3574.0,
            "percent_change": 3.08
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_12",
          "category": "time_period_comparison",
          "question": "Compare the total Sessions between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Sessions",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 116191.0
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 119765.0
          },
          "expected_result": {
            "period_1_value": 116191.0,
            "period_2_value": 119765.0,
            "absolute_difference": 3574.0,
            "percent_change": 3.08
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_13",
          "category": "time_period_comparison",
          "question": "Compare the total Clicks between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Clicks",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 15898.0
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 18856.0
          },
          "expected_result": {
            "period_1_value": 15898.0,
            "period_2_value": 18856.0,
            "absolute_difference": 2958.0,
            "percent_change": 18.61
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_14",
          "category": "time_period_comparison",
          "question": "Compare the total Conversion Rate between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Conversion Rate",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 0.9793
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 0.8125
          },
          "expected_result": {
            "period_1_value": 0.9793,
            "period_2_value": 0.8125,
            "absolute_difference": -0.16679999999999995,
            "percent_change": -17.03
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_15",
          "category": "time_period_comparison",
          "question": "Compare the total Conversion Rate between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27. What is the difference?",
          "metric_column": "Conversion Rate",
          "time_period_1": {
            "start": "2024-01-05",
            "end": "2024-12-28",
            "value": 0.9793
          },
          "time_period_2": {
            "start": "2025-01-01",
            "end": "2025-12-27",
            "value": 0.8125
          },
          "expected_result": {
            "period_1_value": 0.9793,
            "period_2_value": 0.8125,
            "absolute_difference": -0.16679999999999995,
            "percent_change": -17.03
          },
          "difficulty": "medium"
        },
        {
          "id": "time_comp_grouped_1",
          "category": "time_period_comparison_grouped",
          "question": "Compare the total Conversions by Country between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27.",
          "metric_column": "Conversions",
          "group_by_column": "Country",
          "time_period_1": "2024-01-05 to 2024-12-28",
          "time_period_2": "2025-01-01 to 2025-12-27",
          "expected_result": {
            "DE": {
              "period_1": 175.0,
              "period_2": 197.0,
              "difference": 22.0,
              "percent_change": 12.57
            },
            "JP": {
              "period_1": 291.0,
              "period_2": 170.0,
              "difference": -121.0,
              "percent_change": -41.58
            },
            "IN": {
              "period_1": 53.0,
              "period_2": 84.0,
              "difference": 31.0,
              "percent_change": 58.49
            },
            "FR": {
              "period_1": 163.0,
              "period_2": 278.0,
              "difference": 115.0,
              "percent_change": 70.55
            },
            "US": {
              "period_1": 12.0,
              "period_2": 276.0,
              "difference": 264.0,
              "percent_change": 2200.0
            },
            "AU": {
              "period_1": 263.0,
              "period_2": 12.0,
              "difference": -251.0,
              "percent_change": -95.44
            },
            "BR": {
              "period_1": 181.0,
              "period_2": 89.0,
              "difference": -92.0,
              "percent_change": -50.83
            },
            "CA": {
              "period_1": 177.0,
              "period_2": 170.0,
              "difference": -7.0,
              "percent_change": -3.95
            },
            "GB": {
              "period_1": 72.0,
              "period_2": 75.0,
              "difference": 3.0,
              "percent_change": 4.17
            }
          },
          "difficulty": "hard"
        },
        {
          "id": "time_comp_grouped_2",
          "category": "time_period_comparison_grouped",
          "question": "Compare the total Clicks by Agency/PMD (af_prt) between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27.",
          "metric_column": "Clicks",
          "group_by_column": "Agency/PMD (af_prt)",
          "time_period_1": "2024-01-05 to 2024-12-28",
          "time_period_2": "2025-01-01 to 2025-12-27",
          "expected_result": {
            "Agency_5": {
              "period_1": 104.0,
              "period_2": 173.0,
              "difference": 69.0,
              "percent_change": 66.35
            },
            "Agency_2": {
              "period_1": 185.0,
              "period_2": 797.0,
              "difference": 612.0,
              "percent_change": 330.81
            },
            "Agency_4": {
              "period_1": 1471.0,
              "period_2": 832.0,
              "difference": -639.0,
              "percent_change": -43.44
            },
            "Agency_1": {
              "period_1": 153.0,
              "period_2": 1039.0,
              "difference": 886.0,
              "percent_change": 579.08
            },
            "Agency_3": {
              "period_1": 3218.0,
              "period_2": 203.0,
              "difference": -3015.0,
              "percent_change": -93.69
            }
          },
          "difficulty": "hard"
        },
        {
          "id": "time_comp_grouped_3",
          "category": "time_period_comparison_grouped",
          "question": "Compare the total Sessions by Country between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27.",
          "metric_column": "Sessions",
          "group_by_column": "Country",
          "time_period_1": "2024-01-05 to 2024-12-28",
          "time_period_2": "2025-01-01 to 2025-12-27",
          "expected_result": {
            "DE": {
              "period_1": 16986.0,
              "period_2": 16502.0,
              "difference": -484.0,
              "percent_change": -2.85
            },
            "JP": {
              "period_1": 21686.0,
              "period_2": 7984.0,
              "difference": -13702.0,
              "percent_change": -63.18
            },
            "IN": {
              "period_1": 1604.0,
              "period_2": 9921.0,
              "difference": 8317.0,
              "percent_change": 518.52
            },
            "FR": {
              "period_1": 22980.0,
              "period_2": 20847.0,
              "difference": -2133.0,
              "percent_change": -9.28
            },
            "US": {
              "period_1": 348.0,
              "period_2": 26897.0,
              "difference": 26549.0,
              "percent_change": 7629.02
            },
            "AU": {
              "period_1": 19890.0,
              "period_2": 2534.0,
              "difference": -17356.0,
              "percent_change": -87.26
            },
            "BR": {
              "period_1": 15219.0,
              "period_2": 18584.0,
              "difference": 3365.0,
              "percent_change": 22.11
            },
            "CA": {
              "period_1": 12660.0,
              "period_2": 9725.0,
              "difference": -2935.0,
              "percent_change": -23.18
            },
            "GB": {
              "period_1": 4818.0,
              "period_2": 6771.0,
              "difference": 1953.0,
              "percent_change": 40.54
            }
          },
          "difficulty": "hard"
        },
        {
          "id": "time_comp_grouped_4",
          "category": "time_period_comparison_grouped",
          "question": "Compare the total Conversion Rate by Media Source (pid) between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27.",
          "metric_column": "Conversion Rate",
          "group_by_column": "Media Source (pid)",
          "time_period_1": "2024-01-05 to 2024-12-28",
          "time_period_2": "2025-01-01 to 2025-12-27",
          "expected_result": {
            "bing_int": {
              "period_1": 0.1714,
              "period_2": 0.2897,
              "difference": 0.11830000000000002,
              "percent_change": 69.02
            },
            "organic": {
              "period_1": 0.1872,
              "period_2": 0.08310000000000001,
              "difference": -0.1041,
              "percent_change": -55.61
            },
            "applovin_int": {
              "period_1": 0.0663,
              "period_2": 0.13620000000000002,
              "difference": 0.06990000000000002,
              "percent_change": 105.43
            },
            "googleadwords_int": {
              "period_1": 0.0345,
              "period_2": 0.1047,
              "difference": 0.0702,
              "percent_change": 203.48
            },
            "direct": {
              "period_1": 0.14300000000000002,
              "period_2": 0.091,
              "difference": -0.05200000000000002,
              "percent_change": -36.36
            },
            "facebook_int": {
              "period_1": 0.3769,
              "period_2": 0.1078,
              "difference": -0.2691,
              "percent_change": -71.4
            }
          },
          "difficulty": "hard"
        },
        {
          "id": "time_comp_grouped_5",
          "category": "time_period_comparison_grouped",
          "question": "Compare the total Sessions by Campaign (c) between 2024-01-05 to 2024-12-28 and 2025-01-01 to 2025-12-27.",
          "metric_column": "Sessions",
          "group_by_column": "Campaign (c)",
          "time_period_1": "2024-01-05 to 2024-12-28",
          "time_period_2": "2025-01-01 to 2025-12-27",
          "expected_result": {
            "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": {
              "period_1": 13022.0,
              "period_2": 25536.0,
              "difference": 12514.0,
              "percent_change": 96.1
            },
            "Retargeting_Campaign_Web": {
              "period_1": 13598.0,
              "period_2": 8541.0,
              "difference": -5057.0,
              "percent_change": -37.19
            },
            "Brand_Campaign_Q3": {
              "period_1": 27226.0,
              "period_2": 17992.0,
              "difference": -9234.0,
              "percent_change": -33.92
            },
            "App_Install_Campaign_Android": {
              "period_1": 19521.0,
              "period_2": 29156.0,
              "difference": 9635.0,
              "percent_change": 49.36
            },
            "Generic_Campaign_Mobile": {
              "period_1": 23836.0,
              "period_2": 18138.0,
              "difference": -5698.0,
              "percent_change": -23.91
            },
            "SB_UAC_Hindi_KYC_Completed_April'24": {
              "period_1": 9813.0,
              "period_2": 9047.0,
              "difference": -766.0,
              "percent_change": -7.81
            },
            "Lead_Generation_Campaign": {
              "period_1": 9175.0,
              "period_2": 11355.0,
              "difference": 2180.0,
              "percent_change": 23.76
            }
          },
          "difficulty": "hard"
        }
      ]
    },
    "custom_metrics": {
      "description": "Test cases for calculating and aggregating custom business metrics",
      "count": 4,
      "cases": [
        {
          "id": "custom_metric_3",
          "category": "custom_metrics",
          "question": "Calculate the average Conversion Rate across all records. Formula: Conversions / Clicks * 100",
          "metric_name": "Conversion Rate",
          "metric_formula": "Conversions / Clicks * 100",
          "metric_description": "Conversion rate percentage",
          "aggregation_function": "mean",
          "required_columns": [
            "Conversions",
            "Clicks"
          ],
          "expected_result": 23.83,
          "difficulty": "medium"
        },
        {
          "id": "custom_metric_8",
          "category": "custom_metrics",
          "question": "Calculate the average Conversion Rate across all records. Formula: Conversions / Clicks * 100",
          "metric_name": "Conversion Rate",
          "metric_formula": "Conversions / Clicks * 100",
          "metric_description": "Conversion rate percentage",
          "aggregation_function": "mean",
          "required_columns": [
            "Conversions",
            "Clicks"
          ],
          "expected_result": 23.83,
          "difficulty": "medium"
        },
        {
          "id": "custom_metric_15",
          "category": "custom_metrics",
          "question": "Calculate the average Conversion Rate across all records. Formula: Conversions / Clicks * 100",
          "metric_name": "Conversion Rate",
          "metric_formula": "Conversions / Clicks * 100",
          "metric_description": "Conversion rate percentage",
          "aggregation_function": "mean",
          "required_columns": [
            "Conversions",
            "Clicks"
          ],
          "expected_result": 23.83,
          "difficulty": "medium"
        },
        {
          "id": "custom_metric_grouped_2",
          "category": "custom_metrics_grouped",
          "question": "Calculate the average Conversion Rate by Campaign (c). Formula: Conversions / Clicks * 100",
          "metric_name": "Conversion Rate",
          "metric_formula": "Conversions / Clicks * 100",
          "metric_description": "Conversion rate percentage",
          "group_by_column": "Campaign (c)",
          "aggregation_function": "mean",
          "required_columns": [
            "Conversions",
            "Clicks"
          ],
          "expected_result": {
            "App_Install_Campaign_Android": 8.75,
            "Brand_Campaign_Q3": 10.4,
            "Generic_Campaign_Mobile": 95.95,
            "Lead_Generation_Campaign": 6.45,
            "Retargeting_Campaign_Web": 12.04,
            "SB_UAC_Hindi_KYC_Completed_April'24": 8.84,
            "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 9.11
          },
          "difficulty": "hard"
        }
      ]
    }
  }
}