{
  "metadata": {
    "generated_at": "2025-10-16T13:50:38.485799",
    "source_data": "synthetic marketing data",
    "total_cases": 50
  },
  "cases": [
    {
      "id": "agg_1",
      "category": "data_aggregation",
      "question": "What is the avg of Sessions by Media Source (pid)?",
      "operation": "GROUP BY Media Source (pid), MEAN(Sessions)",
      "group_by_column": "Media Source (pid)",
      "metric_column": "Sessions",
      "aggregation_function": "mean",
      "expected_result": {
        "bingads_int": 511.90909090909093,
        "direct": 540.95,
        "facebook_int": 586.3888888888889,
        "googleadwords_int": 494.76190476190476,
        "organic": 499.54545454545456,
        "twitter_int": 544.625
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_2",
      "category": "data_aggregation",
      "question": "What is the min of Sessions by Country?",
      "operation": "GROUP BY Country, MIN(Sessions)",
      "group_by_column": "Country",
      "metric_column": "Sessions",
      "aggregation_function": "min",
      "expected_result": {
        "AU": 99.0,
        "BR": 294.0,
        "CA": 111.0,
        "DE": 118.0,
        "FR": 73.0,
        "GB": 150.0,
        "IN": 256.0,
        "JP": 201.0,
        "US": 147.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_3",
      "category": "data_aggregation",
      "question": "What is the total of Conversions by Media Source (pid)?",
      "operation": "GROUP BY Media Source (pid), SUM(Conversions)",
      "group_by_column": "Media Source (pid)",
      "metric_column": "Conversions",
      "aggregation_function": "sum",
      "expected_result": {
        "bingads_int": 264.0,
        "direct": 307.0,
        "facebook_int": 208.0,
        "googleadwords_int": 163.0,
        "organic": 78.0,
        "twitter_int": 81.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_4",
      "category": "data_aggregation",
      "question": "What is the avg of Sessions by Conversion Type?",
      "operation": "GROUP BY Conversion Type, MEAN(Sessions)",
      "group_by_column": "Conversion Type",
      "metric_column": "Sessions",
      "aggregation_function": "mean",
      "expected_result": {
        "attribution": 592.4545454545455,
        "re-attribution": 488.1714285714286,
        "view-through": 507.53125
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_5",
      "category": "data_aggregation",
      "question": "What is the min of Conversion Rate by Media Source (pid)?",
      "operation": "GROUP BY Media Source (pid), MIN(Conversion Rate)",
      "group_by_column": "Media Source (pid)",
      "metric_column": "Conversion Rate",
      "aggregation_function": "min",
      "expected_result": {
        "bingads_int": 0.0,
        "direct": 0.0,
        "facebook_int": 0.0,
        "googleadwords_int": 0.0,
        "organic": 0.0,
        "twitter_int": 0.0045112781954887
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_6",
      "category": "data_aggregation",
      "question": "What is the max of Clicks by Media Source (pid)?",
      "operation": "GROUP BY Media Source (pid), MAX(Clicks)",
      "group_by_column": "Media Source (pid)",
      "metric_column": "Clicks",
      "aggregation_function": "max",
      "expected_result": {
        "bingads_int": 839.0,
        "direct": 974.0,
        "facebook_int": 970.0,
        "googleadwords_int": 440.0,
        "organic": 565.0,
        "twitter_int": 665.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_7",
      "category": "data_aggregation",
      "question": "What is the max of Conversions by Conversion Type?",
      "operation": "GROUP BY Conversion Type, MAX(Conversions)",
      "group_by_column": "Conversion Type",
      "metric_column": "Conversions",
      "aggregation_function": "max",
      "expected_result": {
        "attribution": 84.0,
        "re-attribution": 73.0,
        "view-through": 89.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_8",
      "category": "data_aggregation",
      "question": "What is the total of Clicks by Campaign (c)?",
      "operation": "GROUP BY Campaign (c), SUM(Clicks)",
      "group_by_column": "Campaign (c)",
      "metric_column": "Clicks",
      "aggregation_function": "sum",
      "expected_result": {
        "Brand Campaign - Awareness": 5124.0,
        "New Product Launch": 2473.0,
        "Performance Campaign - Conversions": 3800.0,
        "SB_UAC_Hindi_KYC_Completed_April'24": 1655.0,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 3369.0,
        "Summer Sale - Limited Time Offer": 3067.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_9",
      "category": "data_aggregation",
      "question": "What is the avg of Conversion Rate by Agency/PMD (af_prt)?",
      "operation": "GROUP BY Agency/PMD (af_prt), MEAN(Conversion Rate)",
      "group_by_column": "Agency/PMD (af_prt)",
      "metric_column": "Conversion Rate",
      "aggregation_function": "mean",
      "expected_result": {
        "Agency_1": 0.05449739189378581,
        "Agency_2": 0.022705146809166726,
        "Agency_3": 0.057253145533968555,
        "Agency_4": 0.07037713671600963,
        "Agency_5": 0.04395578318543423
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_10",
      "category": "data_aggregation",
      "question": "What is the avg of Conversions by Agency/PMD (af_prt)?",
      "operation": "GROUP BY Agency/PMD (af_prt), MEAN(Conversions)",
      "group_by_column": "Agency/PMD (af_prt)",
      "metric_column": "Conversions",
      "aggregation_function": "mean",
      "expected_result": {
        "Agency_1": 14.428571428571429,
        "Agency_2": 2.75,
        "Agency_3": 14.454545454545455,
        "Agency_4": 9.625,
        "Agency_5": 12.307692307692308
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_11",
      "category": "data_aggregation",
      "question": "What is the avg of Conversions by Country?",
      "operation": "GROUP BY Country, MEAN(Conversions)",
      "group_by_column": "Country",
      "metric_column": "Conversions",
      "aggregation_function": "mean",
      "expected_result": {
        "AU": 13.066666666666666,
        "BR": 9.333333333333334,
        "CA": 19.25,
        "DE": 7.857142857142857,
        "FR": 5.857142857142857,
        "GB": 10.666666666666666,
        "IN": 11.2,
        "JP": 8.818181818181818,
        "US": 11.076923076923077
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_12",
      "category": "data_aggregation",
      "question": "What is the number of of Conversion Rate by Conversion Type?",
      "operation": "GROUP BY Conversion Type, COUNT(Conversion Rate)",
      "group_by_column": "Conversion Type",
      "metric_column": "Conversion Rate",
      "aggregation_function": "count",
      "expected_result": {
        "attribution": 27.0,
        "re-attribution": 30.0,
        "view-through": 26.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_13",
      "category": "data_aggregation",
      "question": "What is the number of of Conversion Rate by Media Source (pid)?",
      "operation": "GROUP BY Media Source (pid), COUNT(Conversion Rate)",
      "group_by_column": "Media Source (pid)",
      "metric_column": "Conversion Rate",
      "aggregation_function": "count",
      "expected_result": {
        "bingads_int": 20.0,
        "direct": 17.0,
        "facebook_int": 13.0,
        "googleadwords_int": 17.0,
        "organic": 10.0,
        "twitter_int": 6.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_14",
      "category": "data_aggregation",
      "question": "What is the number of of Clicks by Conversion Type?",
      "operation": "GROUP BY Conversion Type, COUNT(Clicks)",
      "group_by_column": "Conversion Type",
      "metric_column": "Clicks",
      "aggregation_function": "count",
      "expected_result": {
        "attribution": 28.0,
        "re-attribution": 30.0,
        "view-through": 26.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_15",
      "category": "data_aggregation",
      "question": "What is the total of Conversions by Campaign (c)?",
      "operation": "GROUP BY Campaign (c), SUM(Conversions)",
      "group_by_column": "Campaign (c)",
      "metric_column": "Conversions",
      "aggregation_function": "sum",
      "expected_result": {
        "Brand Campaign - Awareness": 259.0,
        "New Product Launch": 126.0,
        "Performance Campaign - Conversions": 263.0,
        "SB_UAC_Hindi_KYC_Completed_April'24": 90.0,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 225.0,
        "Summer Sale - Limited Time Offer": 138.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_16",
      "category": "data_aggregation",
      "question": "What is the avg of Conversions by Media Source (pid)?",
      "operation": "GROUP BY Media Source (pid), MEAN(Conversions)",
      "group_by_column": "Media Source (pid)",
      "metric_column": "Conversions",
      "aggregation_function": "mean",
      "expected_result": {
        "bingads_int": 12.0,
        "direct": 15.35,
        "facebook_int": 11.555555555555555,
        "googleadwords_int": 7.761904761904762,
        "organic": 7.090909090909091,
        "twitter_int": 10.125
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_17",
      "category": "data_aggregation",
      "question": "What is the max of Sessions by Campaign (c)?",
      "operation": "GROUP BY Campaign (c), MAX(Sessions)",
      "group_by_column": "Campaign (c)",
      "metric_column": "Sessions",
      "aggregation_function": "max",
      "expected_result": {
        "Brand Campaign - Awareness": 981.0,
        "New Product Launch": 966.0,
        "Performance Campaign - Conversions": 960.0,
        "SB_UAC_Hindi_KYC_Completed_April'24": 895.0,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 991.0,
        "Summer Sale - Limited Time Offer": 948.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_18",
      "category": "data_aggregation",
      "question": "What is the avg of Conversion Rate by Country?",
      "operation": "GROUP BY Country, MEAN(Conversion Rate)",
      "group_by_column": "Country",
      "metric_column": "Conversion Rate",
      "aggregation_function": "mean",
      "expected_result": {
        "AU": 0.0600392167468483,
        "BR": 0.0504129373706891,
        "CA": 0.046543068395132774,
        "DE": 0.041257305320126184,
        "FR": 0.04345350707952074,
        "GB": 0.06489698196151103,
        "IN": 0.02168130998506399,
        "JP": 0.04382603934798118,
        "US": 0.06040727018043712
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_19",
      "category": "data_aggregation",
      "question": "What is the max of Sessions by Conversion Type?",
      "operation": "GROUP BY Conversion Type, MAX(Sessions)",
      "group_by_column": "Conversion Type",
      "metric_column": "Sessions",
      "aggregation_function": "max",
      "expected_result": {
        "attribution": 981.0,
        "re-attribution": 960.0,
        "view-through": 991.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_20",
      "category": "data_aggregation",
      "question": "What is the avg of Sessions by Campaign (c)?",
      "operation": "GROUP BY Campaign (c), MEAN(Sessions)",
      "group_by_column": "Campaign (c)",
      "metric_column": "Sessions",
      "aggregation_function": "mean",
      "expected_result": {
        "Brand Campaign - Awareness": 578.9411764705883,
        "New Product Launch": 468.3333333333333,
        "Performance Campaign - Conversions": 496.77777777777777,
        "SB_UAC_Hindi_KYC_Completed_April'24": 518.7857142857143,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 507.3157894736842,
        "Summer Sale - Limited Time Offer": 625.8571428571429
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_multi_1",
      "category": "data_aggregation_multi_group",
      "question": "What is the total of Sessions grouped by Agency/PMD (af_prt) and Country?",
      "operation": "GROUP BY Agency/PMD (af_prt), Country, SUM(Sessions)",
      "group_by_columns": [
        "Agency/PMD (af_prt)",
        "Country"
      ],
      "metric_column": "Sessions",
      "aggregation_function": "sum",
      "expected_result": {
        "Agency_1_AU": 854.0,
        "Agency_1_BR": 495.0,
        "Agency_1_CA": 234.0,
        "Agency_1_DE": 594.0,
        "Agency_1_FR": 329.0,
        "Agency_1_GB": 671.0,
        "Agency_1_IN": 2561.0,
        "Agency_1_JP": 1497.0,
        "Agency_1_US": 883.0,
        "Agency_2_AU": 1326.0,
        "Agency_2_CA": 873.0,
        "Agency_2_FR": 2068.0,
        "Agency_2_GB": 551.0,
        "Agency_3_AU": 2092.0,
        "Agency_3_CA": 778.0,
        "Agency_3_DE": 327.0,
        "Agency_3_GB": 633.0,
        "Agency_3_IN": 1448.0,
        "Agency_3_JP": 520.0,
        "Agency_3_US": 366.0,
        "Agency_4_AU": 396.0,
        "Agency_4_CA": 1799.0,
        "Agency_4_DE": 587.0,
        "Agency_4_US": 1396.0,
        "Agency_5_AU": 343.0,
        "Agency_5_BR": 1149.0,
        "Agency_5_CA": 815.0,
        "Agency_5_FR": 960.0,
        "Agency_5_GB": 150.0,
        "Agency_5_IN": 303.0,
        "Agency_5_JP": 2121.0,
        "Agency_5_US": 642.0
      },
      "difficulty": "hard"
    },
    {
      "id": "agg_multi_2",
      "category": "data_aggregation_multi_group",
      "question": "What is the avg of Conversions grouped by Country and Media Source (pid)?",
      "operation": "GROUP BY Country, Media Source (pid), MEAN(Conversions)",
      "group_by_columns": [
        "Country",
        "Media Source (pid)"
      ],
      "metric_column": "Conversions",
      "aggregation_function": "mean",
      "expected_result": {
        "AU_bingads_int": 12.5,
        "AU_direct": 18.8,
        "AU_facebook_int": 2.0,
        "AU_googleadwords_int": 11.666666666666666,
        "AU_organic": 10.0,
        "AU_twitter_int": 5.0,
        "BR_direct": 6.0,
        "BR_googleadwords_int": 20.5,
        "BR_organic": 1.5,
        "CA_bingads_int": 36.5,
        "CA_direct": 9.5,
        "CA_facebook_int": 34.333333333333336,
        "CA_googleadwords_int": 1.0,
        "CA_organic": 8.0,
        "CA_twitter_int": 13.0,
        "DE_bingads_int": 7.5,
        "DE_facebook_int": 0.0,
        "DE_googleadwords_int": 7.5,
        "DE_organic": 12.5,
        "FR_bingads_int": 8.666666666666666,
        "FR_direct": 2.5,
        "FR_facebook_int": 38.0,
        "FR_googleadwords_int": 1.3333333333333333,
        "FR_organic": 0.0,
        "FR_twitter_int": 2.0,
        "GB_bingads_int": 4.0,
        "GB_facebook_int": 6.8,
        "GB_googleadwords_int": 6.666666666666667,
        "GB_organic": 24.0,
        "GB_twitter_int": 23.0,
        "IN_bingads_int": 3.3333333333333335,
        "IN_direct": 29.0,
        "IN_facebook_int": 3.5,
        "IN_googleadwords_int": 3.0,
        "IN_organic": 5.0,
        "JP_bingads_int": 13.0,
        "JP_direct": 19.0,
        "JP_facebook_int": 6.5,
        "JP_googleadwords_int": 2.5,
        "JP_organic": 2.0,
        "JP_twitter_int": 0.0,
        "US_bingads_int": 11.75,
        "US_direct": 23.5,
        "US_facebook_int": 3.6666666666666665,
        "US_googleadwords_int": 12.666666666666666,
        "US_organic": 1.0
      },
      "difficulty": "hard"
    },
    {
      "id": "agg_multi_3",
      "category": "data_aggregation_multi_group",
      "question": "What is the avg of Clicks grouped by Media Source (pid) and Country?",
      "operation": "GROUP BY Media Source (pid), Country, MEAN(Clicks)",
      "group_by_columns": [
        "Media Source (pid)",
        "Country"
      ],
      "metric_column": "Clicks",
      "aggregation_function": "mean",
      "expected_result": {
        "bingads_int_AU": 235.5,
        "bingads_int_CA": 493.0,
        "bingads_int_DE": 257.0,
        "bingads_int_FR": 119.66666666666667,
        "bingads_int_GB": null,
        "bingads_int_IN": 331.3333333333333,
        "bingads_int_JP": 196.66666666666666,
        "bingads_int_US": 168.5,
        "direct_AU": 301.5,
        "direct_BR": 241.0,
        "direct_CA": 236.0,
        "direct_FR": 57.75,
        "direct_IN": 555.0,
        "direct_JP": 256.5,
        "direct_US": 279.0,
        "facebook_int_AU": 69.0,
        "facebook_int_CA": 556.0,
        "facebook_int_DE": 20.0,
        "facebook_int_FR": 417.0,
        "facebook_int_GB": 267.0,
        "facebook_int_IN": 309.5,
        "facebook_int_JP": 117.5,
        "facebook_int_US": 92.0,
        "googleadwords_int_AU": 173.5,
        "googleadwords_int_BR": 440.0,
        "googleadwords_int_CA": 10.0,
        "googleadwords_int_DE": 169.5,
        "googleadwords_int_FR": 76.0,
        "googleadwords_int_GB": 91.66666666666667,
        "googleadwords_int_IN": 165.0,
        "googleadwords_int_JP": 81.5,
        "googleadwords_int_US": 288.0,
        "organic_AU": 102.0,
        "organic_BR": 121.0,
        "organic_CA": 228.0,
        "organic_DE": 280.5,
        "organic_FR": 51.0,
        "organic_GB": 290.0,
        "organic_IN": 565.0,
        "organic_JP": 244.0,
        "organic_US": 106.0,
        "twitter_int_AU": 112.0,
        "twitter_int_CA": 535.0,
        "twitter_int_FR": 100.0,
        "twitter_int_GB": 508.0,
        "twitter_int_JP": 0.0
      },
      "difficulty": "hard"
    },
    {
      "id": "agg_multi_4",
      "category": "data_aggregation_multi_group",
      "question": "What is the avg of Conversions grouped by Agency/PMD (af_prt) and Campaign (c)?",
      "operation": "GROUP BY Agency/PMD (af_prt), Campaign (c), MEAN(Conversions)",
      "group_by_columns": [
        "Agency/PMD (af_prt)",
        "Campaign (c)"
      ],
      "metric_column": "Conversions",
      "aggregation_function": "mean",
      "expected_result": {
        "Agency_1_Brand Campaign - Awareness": 11.0,
        "Agency_1_New Product Launch": 16.0,
        "Agency_1_Performance Campaign - Conversions": 26.666666666666668,
        "Agency_1_SB_UAC_Hindi_KYC_Completed_April'24": 1.5,
        "Agency_1_SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 23.0,
        "Agency_1_Summer Sale - Limited Time Offer": 5.0,
        "Agency_2_Brand Campaign - Awareness": 3.0,
        "Agency_2_New Product Launch": 0.0,
        "Agency_2_Performance Campaign - Conversions": 5.333333333333333,
        "Agency_2_SB_UAC_Hindi_KYC_Completed_April'24": 0.0,
        "Agency_2_SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 1.0,
        "Agency_2_Summer Sale - Limited Time Offer": 2.0,
        "Agency_3_Brand Campaign - Awareness": 30.333333333333332,
        "Agency_3_New Product Launch": 6.666666666666667,
        "Agency_3_SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 10.0,
        "Agency_3_Summer Sale - Limited Time Offer": 8.0,
        "Agency_4_Brand Campaign - Awareness": 14.0,
        "Agency_4_New Product Launch": 1.0,
        "Agency_4_Performance Campaign - Conversions": 16.5,
        "Agency_4_SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 2.0,
        "Agency_4_Summer Sale - Limited Time Offer": 9.0,
        "Agency_5_Brand Campaign - Awareness": 4.0,
        "Agency_5_New Product Launch": 3.5,
        "Agency_5_Performance Campaign - Conversions": 19.75,
        "Agency_5_SB_UAC_Hindi_KYC_Completed_April'24": 13.5,
        "Agency_5_SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 12.0
      },
      "difficulty": "hard"
    },
    {
      "id": "agg_multi_5",
      "category": "data_aggregation_multi_group",
      "question": "What is the avg of Conversions grouped by Campaign (c) and Agency/PMD (af_prt)?",
      "operation": "GROUP BY Campaign (c), Agency/PMD (af_prt), MEAN(Conversions)",
      "group_by_columns": [
        "Campaign (c)",
        "Agency/PMD (af_prt)"
      ],
      "metric_column": "Conversions",
      "aggregation_function": "mean",
      "expected_result": {
        "Brand Campaign - Awareness_Agency_1": 11.0,
        "Brand Campaign - Awareness_Agency_2": 3.0,
        "Brand Campaign - Awareness_Agency_3": 30.333333333333332,
        "Brand Campaign - Awareness_Agency_4": 14.0,
        "Brand Campaign - Awareness_Agency_5": 4.0,
        "New Product Launch_Agency_1": 16.0,
        "New Product Launch_Agency_2": 0.0,
        "New Product Launch_Agency_3": 6.666666666666667,
        "New Product Launch_Agency_4": 1.0,
        "New Product Launch_Agency_5": 3.5,
        "Performance Campaign - Conversions_Agency_1": 26.666666666666668,
        "Performance Campaign - Conversions_Agency_2": 5.333333333333333,
        "Performance Campaign - Conversions_Agency_4": 16.5,
        "Performance Campaign - Conversions_Agency_5": 19.75,
        "SB_UAC_Hindi_KYC_Completed_April'24_Agency_1": 1.5,
        "SB_UAC_Hindi_KYC_Completed_April'24_Agency_2": 0.0,
        "SB_UAC_Hindi_KYC_Completed_April'24_Agency_5": 13.5,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22_Agency_1": 23.0,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22_Agency_2": 1.0,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22_Agency_3": 10.0,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22_Agency_4": 2.0,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22_Agency_5": 12.0,
        "Summer Sale - Limited Time Offer_Agency_1": 5.0,
        "Summer Sale - Limited Time Offer_Agency_2": 2.0,
        "Summer Sale - Limited Time Offer_Agency_3": 8.0,
        "Summer Sale - Limited Time Offer_Agency_4": 9.0
      },
      "difficulty": "hard"
    }
  ]
}