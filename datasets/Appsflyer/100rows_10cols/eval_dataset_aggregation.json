{
  "metadata": {
    "generated_at": "2025-10-16T14:13:31.025617",
    "source_data": "synthetic marketing data",
    "total_cases": 49
  },
  "cases": [
    {
      "id": "agg_1",
      "category": "data_aggregation",
      "question": "What is the total of Clicks by Agency/PMD (af_prt)?",
      "operation": "GROUP BY Agency/PMD (af_prt), SUM(Clicks)",
      "group_by_column": "Agency/PMD (af_prt)",
      "metric_column": "Clicks",
      "aggregation_function": "sum",
      "expected_result": {
        "Agency_1": 1192.0,
        "Agency_2": 982.0,
        "Agency_3": 3421.0,
        "Agency_4": 2303.0,
        "Agency_5": 277.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_2",
      "category": "data_aggregation",
      "question": "What is the max of Conversions by Conversion Type?",
      "operation": "GROUP BY Conversion Type, MAX(Conversions)",
      "group_by_column": "Conversion Type",
      "metric_column": "Conversions",
      "aggregation_function": "max",
      "expected_result": {
        "install": 50.0,
        "lead": 49.0,
        "purchase": 50.0,
        "re-attribution": 47.0,
        "sign_up": 50.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_3",
      "category": "data_aggregation",
      "question": "What is the number of of Conversion Rate by Media Source (pid)?",
      "operation": "GROUP BY Media Source (pid), COUNT(Conversion Rate)",
      "group_by_column": "Media Source (pid)",
      "metric_column": "Conversion Rate",
      "aggregation_function": "count",
      "expected_result": {
        "applovin_int": 11.0,
        "bing_int": 18.0,
        "direct": 17.0,
        "facebook_int": 9.0,
        "googleadwords_int": 8.0,
        "organic": 12.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_4",
      "category": "data_aggregation",
      "question": "What is the number of of Conversions by Conversion Type?",
      "operation": "GROUP BY Conversion Type, COUNT(Conversions)",
      "group_by_column": "Conversion Type",
      "metric_column": "Conversions",
      "aggregation_function": "count",
      "expected_result": {
        "install": 26.0,
        "lead": 16.0,
        "purchase": 20.0,
        "re-attribution": 20.0,
        "sign_up": 18.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_5",
      "category": "data_aggregation",
      "question": "What is the number of of Sessions by Agency/PMD (af_prt)?",
      "operation": "GROUP BY Agency/PMD (af_prt), COUNT(Sessions)",
      "group_by_column": "Agency/PMD (af_prt)",
      "metric_column": "Sessions",
      "aggregation_function": "count",
      "expected_result": {
        "Agency_1": 6.0,
        "Agency_2": 5.0,
        "Agency_3": 9.0,
        "Agency_4": 6.0,
        "Agency_5": 2.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_6",
      "category": "data_aggregation",
      "question": "What is the max of Conversions by Conversion Type?",
      "operation": "GROUP BY Conversion Type, MAX(Conversions)",
      "group_by_column": "Conversion Type",
      "metric_column": "Conversions",
      "aggregation_function": "max",
      "expected_result": {
        "install": 50.0,
        "lead": 49.0,
        "purchase": 50.0,
        "re-attribution": 47.0,
        "sign_up": 50.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_7",
      "category": "data_aggregation",
      "question": "What is the total of Clicks by Campaign (c)?",
      "operation": "GROUP BY Campaign (c), SUM(Clicks)",
      "group_by_column": "Campaign (c)",
      "metric_column": "Clicks",
      "aggregation_function": "sum",
      "expected_result": {
        "App_Install_Campaign_Android": 6834.0,
        "Brand_Campaign_Q3": 5508.0,
        "Generic_Campaign_Mobile": 5302.0,
        "Lead_Generation_Campaign": 4277.0,
        "Retargeting_Campaign_Web": 4299.0,
        "SB_UAC_Hindi_KYC_Completed_April'24": 3093.0,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 5441.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_8",
      "category": "data_aggregation",
      "question": "What is the min of Clicks by Agency/PMD (af_prt)?",
      "operation": "GROUP BY Agency/PMD (af_prt), MIN(Clicks)",
      "group_by_column": "Agency/PMD (af_prt)",
      "metric_column": "Clicks",
      "aggregation_function": "min",
      "expected_result": {
        "Agency_1": 153.0,
        "Agency_2": 5.0,
        "Agency_3": 136.0,
        "Agency_4": 261.0,
        "Agency_5": 104.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_9",
      "category": "data_aggregation",
      "question": "What is the avg of Conversions by Conversion Type?",
      "operation": "GROUP BY Conversion Type, MEAN(Conversions)",
      "group_by_column": "Conversion Type",
      "metric_column": "Conversions",
      "aggregation_function": "mean",
      "expected_result": {
        "install": 25.384615384615383,
        "lead": 34.0625,
        "purchase": 27.75,
        "re-attribution": 24.0,
        "sign_up": 27.666666666666668
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_10",
      "category": "data_aggregation",
      "question": "What is the avg of Conversions by Conversion Type?",
      "operation": "GROUP BY Conversion Type, MEAN(Conversions)",
      "group_by_column": "Conversion Type",
      "metric_column": "Conversions",
      "aggregation_function": "mean",
      "expected_result": {
        "install": 25.384615384615383,
        "lead": 34.0625,
        "purchase": 27.75,
        "re-attribution": 24.0,
        "sign_up": 27.666666666666668
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_11",
      "category": "data_aggregation",
      "question": "What is the total of Conversions by Agency/PMD (af_prt)?",
      "operation": "GROUP BY Agency/PMD (af_prt), SUM(Conversions)",
      "group_by_column": "Agency/PMD (af_prt)",
      "metric_column": "Conversions",
      "aggregation_function": "sum",
      "expected_result": {
        "Agency_1": 160.0,
        "Agency_2": 144.0,
        "Agency_3": 211.0,
        "Agency_4": 168.0,
        "Agency_5": 79.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_12",
      "category": "data_aggregation",
      "question": "What is the min of Conversion Rate by Conversion Type?",
      "operation": "GROUP BY Conversion Type, MIN(Conversion Rate)",
      "group_by_column": "Conversion Type",
      "metric_column": "Conversion Rate",
      "aggregation_function": "min",
      "expected_result": {
        "install": 0.0002,
        "lead": 0.0072,
        "purchase": 0.0005,
        "re-attribution": 0.0003,
        "sign_up": 0.0008
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_13",
      "category": "data_aggregation",
      "question": "What is the total of Conversions by Country?",
      "operation": "GROUP BY Country, SUM(Conversions)",
      "group_by_column": "Country",
      "metric_column": "Conversions",
      "aggregation_function": "sum",
      "expected_result": {
        "AU": 275.0,
        "BR": 270.0,
        "CA": 347.0,
        "DE": 372.0,
        "FR": 441.0,
        "GB": 147.0,
        "IN": 137.0,
        "JP": 461.0,
        "US": 288.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_14",
      "category": "data_aggregation",
      "question": "What is the total of Conversion Rate by Conversion Type?",
      "operation": "GROUP BY Conversion Type, SUM(Conversion Rate)",
      "group_by_column": "Conversion Type",
      "metric_column": "Conversion Rate",
      "aggregation_function": "sum",
      "expected_result": {
        "install": 0.2656,
        "lead": 0.4053,
        "purchase": 0.5464,
        "re-attribution": 0.3549,
        "sign_up": 0.2196
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_15",
      "category": "data_aggregation",
      "question": "What is the number of of Conversions by Agency/PMD (af_prt)?",
      "operation": "GROUP BY Agency/PMD (af_prt), COUNT(Conversions)",
      "group_by_column": "Agency/PMD (af_prt)",
      "metric_column": "Conversions",
      "aggregation_function": "count",
      "expected_result": {
        "Agency_1": 6.0,
        "Agency_2": 5.0,
        "Agency_3": 9.0,
        "Agency_4": 6.0,
        "Agency_5": 2.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_16",
      "category": "data_aggregation",
      "question": "What is the number of of Clicks by Agency/PMD (af_prt)?",
      "operation": "GROUP BY Agency/PMD (af_prt), COUNT(Clicks)",
      "group_by_column": "Agency/PMD (af_prt)",
      "metric_column": "Clicks",
      "aggregation_function": "count",
      "expected_result": {
        "Agency_1": 3.0,
        "Agency_2": 4.0,
        "Agency_3": 8.0,
        "Agency_4": 4.0,
        "Agency_5": 2.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_17",
      "category": "data_aggregation",
      "question": "What is the min of Sessions by Campaign (c)?",
      "operation": "GROUP BY Campaign (c), MIN(Sessions)",
      "group_by_column": "Campaign (c)",
      "metric_column": "Sessions",
      "aggregation_function": "min",
      "expected_result": {
        "App_Install_Campaign_Android": 482.0,
        "Brand_Campaign_Q3": 526.0,
        "Generic_Campaign_Mobile": 188.0,
        "Lead_Generation_Campaign": 82.0,
        "Retargeting_Campaign_Web": 539.0,
        "SB_UAC_Hindi_KYC_Completed_April'24": 545.0,
        "SB_UAC_Hindi_KYC_NonFos_Firebase_Nov'22": 298.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_18",
      "category": "data_aggregation",
      "question": "What is the avg of Sessions by Agency/PMD (af_prt)?",
      "operation": "GROUP BY Agency/PMD (af_prt), MEAN(Sessions)",
      "group_by_column": "Agency/PMD (af_prt)",
      "metric_column": "Sessions",
      "aggregation_function": "mean",
      "expected_result": {
        "Agency_1": 1866.5,
        "Agency_2": 2315.0,
        "Agency_3": 2256.4444444444443,
        "Agency_4": 2010.0,
        "Agency_5": 1559.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_19",
      "category": "data_aggregation",
      "question": "What is the avg of Sessions by Country?",
      "operation": "GROUP BY Country, MEAN(Sessions)",
      "group_by_column": "Country",
      "metric_column": "Sessions",
      "aggregation_function": "mean",
      "expected_result": {
        "AU": 2242.4,
        "BR": 2816.9166666666665,
        "CA": 2035.0,
        "DE": 2576.0,
        "FR": 2578.0588235294117,
        "GB": 2317.8,
        "IN": 2305.0,
        "JP": 1854.375,
        "US": 2476.818181818182
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_20",
      "category": "data_aggregation",
      "question": "What is the number of of Conversion Rate by Media Source (pid)?",
      "operation": "GROUP BY Media Source (pid), COUNT(Conversion Rate)",
      "group_by_column": "Media Source (pid)",
      "metric_column": "Conversion Rate",
      "aggregation_function": "count",
      "expected_result": {
        "applovin_int": 11.0,
        "bing_int": 18.0,
        "direct": 17.0,
        "facebook_int": 9.0,
        "googleadwords_int": 8.0,
        "organic": 12.0
      },
      "difficulty": "medium"
    },
    {
      "id": "agg_multi_1",
      "category": "data_aggregation_multi_group",
      "question": "What is the avg of Sessions grouped by Agency/PMD (af_prt) and Media Source (pid)?",
      "operation": "GROUP BY Agency/PMD (af_prt), Media Source (pid), MEAN(Sessions)",
      "group_by_columns": [
        "Agency/PMD (af_prt)",
        "Media Source (pid)"
      ],
      "metric_column": "Sessions",
      "aggregation_function": "mean",
      "expected_result": {
        "Agency_1_bing_int": 2512.5,
        "Agency_1_direct": 1688.5,
        "Agency_1_googleadwords_int": 2271.0,
        "Agency_1_organic": 526.0,
        "Agency_2_applovin_int": 4991.0,
        "Agency_2_facebook_int": 188.0,
        "Agency_2_googleadwords_int": 1617.5,
        "Agency_2_organic": 3161.0,
        "Agency_3_applovin_int": 4439.0,
        "Agency_3_bing_int": 2051.0,
        "Agency_3_direct": 1378.0,
        "Agency_3_facebook_int": 674.0,
        "Agency_3_organic": 4235.0,
        "Agency_4_bing_int": 2166.5,
        "Agency_4_direct": 1435.5,
        "Agency_4_googleadwords_int": 687.0,
        "Agency_4_organic": 4169.0,
        "Agency_5_applovin_int": 1640.0,
        "Agency_5_organic": 1478.0
      },
      "difficulty": "hard"
    },
    {
      "id": "agg_multi_2",
      "category": "data_aggregation_multi_group",
      "question": "What is the number of of Conversion Rate grouped by Media Source (pid) and Conversion Type?",
      "operation": "GROUP BY Media Source (pid), Conversion Type, COUNT(Conversion Rate)",
      "group_by_columns": [
        "Media Source (pid)",
        "Conversion Type"
      ],
      "metric_column": "Conversion Rate",
      "aggregation_function": "count",
      "expected_result": {
        "applovin_int_install": 4.0,
        "applovin_int_lead": 2.0,
        "applovin_int_purchase": 1.0,
        "applovin_int_re-attribution": 2.0,
        "applovin_int_sign_up": 2.0,
        "bing_int_install": 4.0,
        "bing_int_lead": 5.0,
        "bing_int_purchase": 3.0,
        "bing_int_re-attribution": 3.0,
        "bing_int_sign_up": 3.0,
        "direct_install": 2.0,
        "direct_lead": 1.0,
        "direct_purchase": 5.0,
        "direct_re-attribution": 4.0,
        "direct_sign_up": 5.0,
        "facebook_int_install": 2.0,
        "facebook_int_lead": 1.0,
        "facebook_int_purchase": 1.0,
        "facebook_int_re-attribution": 3.0,
        "facebook_int_sign_up": 2.0,
        "googleadwords_int_install": 3.0,
        "googleadwords_int_lead": 1.0,
        "googleadwords_int_purchase": 2.0,
        "googleadwords_int_re-attribution": 1.0,
        "googleadwords_int_sign_up": 1.0,
        "organic_install": 2.0,
        "organic_lead": 2.0,
        "organic_purchase": 5.0,
        "organic_re-attribution": 2.0,
        "organic_sign_up": 1.0
      },
      "difficulty": "hard"
    },
    {
      "id": "agg_multi_3",
      "category": "data_aggregation_multi_group",
      "question": "What is the number of of Conversion Rate grouped by Agency/PMD (af_prt) and Conversion Type?",
      "operation": "GROUP BY Agency/PMD (af_prt), Conversion Type, COUNT(Conversion Rate)",
      "group_by_columns": [
        "Agency/PMD (af_prt)",
        "Conversion Type"
      ],
      "metric_column": "Conversion Rate",
      "aggregation_function": "count",
      "expected_result": {
        "Agency_1_install": 1.0,
        "Agency_1_purchase": 1.0,
        "Agency_1_re-attribution": 2.0,
        "Agency_1_sign_up": 1.0,
        "Agency_2_install": 1.0,
        "Agency_2_lead": 1.0,
        "Agency_2_purchase": 1.0,
        "Agency_3_install": 1.0,
        "Agency_3_lead": 0.0,
        "Agency_3_purchase": 0.0,
        "Agency_3_re-attribution": 3.0,
        "Agency_3_sign_up": 1.0,
        "Agency_4_install": 0.0,
        "Agency_4_lead": 2.0,
        "Agency_4_purchase": 2.0,
        "Agency_4_re-attribution": 0.0,
        "Agency_5_install": 1.0,
        "Agency_5_sign_up": 1.0
      },
      "difficulty": "hard"
    },
    {
      "id": "agg_multi_4",
      "category": "data_aggregation_multi_group",
      "question": "What is the number of of Sessions grouped by Media Source (pid) and Conversion Type?",
      "operation": "GROUP BY Media Source (pid), Conversion Type, COUNT(Sessions)",
      "group_by_columns": [
        "Media Source (pid)",
        "Conversion Type"
      ],
      "metric_column": "Sessions",
      "aggregation_function": "count",
      "expected_result": {
        "applovin_int_install": 5.0,
        "applovin_int_lead": 3.0,
        "applovin_int_purchase": 1.0,
        "applovin_int_re-attribution": 3.0,
        "applovin_int_sign_up": 2.0,
        "bing_int_install": 9.0,
        "bing_int_lead": 6.0,
        "bing_int_purchase": 3.0,
        "bing_int_re-attribution": 4.0,
        "bing_int_sign_up": 4.0,
        "direct_install": 4.0,
        "direct_lead": 1.0,
        "direct_purchase": 8.0,
        "direct_re-attribution": 5.0,
        "direct_sign_up": 5.0,
        "facebook_int_install": 2.0,
        "facebook_int_lead": 2.0,
        "facebook_int_purchase": 1.0,
        "facebook_int_re-attribution": 4.0,
        "facebook_int_sign_up": 3.0,
        "googleadwords_int_install": 4.0,
        "googleadwords_int_lead": 1.0,
        "googleadwords_int_purchase": 2.0,
        "googleadwords_int_re-attribution": 2.0,
        "googleadwords_int_sign_up": 1.0,
        "organic_install": 2.0,
        "organic_lead": 3.0,
        "organic_purchase": 5.0,
        "organic_re-attribution": 2.0,
        "organic_sign_up": 3.0
      },
      "difficulty": "hard"
    },
    {
      "id": "agg_multi_5",
      "category": "data_aggregation_multi_group",
      "question": "What is the number of of Conversions grouped by Agency/PMD (af_prt) and Conversion Type?",
      "operation": "GROUP BY Agency/PMD (af_prt), Conversion Type, COUNT(Conversions)",
      "group_by_columns": [
        "Agency/PMD (af_prt)",
        "Conversion Type"
      ],
      "metric_column": "Conversions",
      "aggregation_function": "count",
      "expected_result": {
        "Agency_1_install": 1.0,
        "Agency_1_purchase": 2.0,
        "Agency_1_re-attribution": 2.0,
        "Agency_1_sign_up": 1.0,
        "Agency_2_install": 1.0,
        "Agency_2_lead": 3.0,
        "Agency_2_purchase": 1.0,
        "Agency_3_install": 2.0,
        "Agency_3_lead": 1.0,
        "Agency_3_purchase": 1.0,
        "Agency_3_re-attribution": 3.0,
        "Agency_3_sign_up": 2.0,
        "Agency_4_install": 1.0,
        "Agency_4_lead": 2.0,
        "Agency_4_purchase": 2.0,
        "Agency_4_re-attribution": 1.0,
        "Agency_5_install": 1.0,
        "Agency_5_sign_up": 1.0
      },
      "difficulty": "hard"
    }
  ]
}